import{j as ee,k as w,l as Y,g as B,q as re,v as fe,H as ae,w as U,x as k,y as z,z as D,C as J,A as ne,B as X,D as ie,E as F,F as E,G as q,I as le,J as $,m as se,K as x,L as ue,M as oe,N as te,O as de,P as K,Q as P,R as L,S as Q,T as ve,U as ce,V as H,W,X as pe,Y as _e,b as he,Z as ge,_ as me,a0 as Ee,a1 as Te}from"./DRxMI7yE.js";import{b as y,c as we}from"./qWX6MBcI.js";function Se(r,n){return n}function Ae(r,n,i){for(var t=[],g=n.length,u,s=n.length,d=0;d<g;d++){let v=n[d];P(v,()=>{if(u){if(u.pending.delete(v),u.done.add(v),u.pending.size===0){var c=r.outrogroups;V(x(u.done)),c.delete(u),c.size===0&&(r.outrogroups=null)}}else s-=1},!1)}if(s===0){var f=t.length===0&&i!==null;if(f){var o=i,a=o.parentNode;ve(a),a.append(o),r.items.clear()}V(n,!f)}else u={pending:new Set(n),done:new Set},(r.outrogroups??=new Set).add(u)}function V(r,n=!0){for(var i=0;i<r.length;i++)ce(r[i],n)}var G;function be(r,n,i,t,g,u=null){var s=r,d=new Map,f=(n&W)!==0;if(f){var o=r;s=w?k(H(o)):o.appendChild(F())}w&&Y();var a=null,v=re(()=>{var l=i();return ue(l)?l:l==null?[]:x(l)}),c,_=!0;function A(){e.fallback=a,Ce(e,c,s,n,t),a!==null&&(c.length===0?(a.f&E)===0?K(a):(a.f^=E,M(a,null,s)):P(a,()=>{a=null}))}var N=ee(()=>{c=B(v);var l=c.length;let R=!1;if(w){var S=fe(s)===ae;S!==(l===0)&&(s=U(),k(s),z(!1),R=!0)}for(var m=new Set,C=ie,b=le(),h=0;h<l;h+=1){w&&D.nodeType===J&&D.data===ne&&(s=D,R=!0,z(!1));var I=c[h],O=t(I,h),p=_?null:d.get(O);p?(p.v&&X(p.v,I),p.i&&X(p.i,h),b&&C.skipped_effects.delete(p.e)):(p=Ie(d,_?s:G??=F(),I,O,h,g,n,i),_||(p.e.f|=E),d.set(O,p)),m.add(O)}if(l===0&&u&&!a&&(_?a=q(()=>u(s)):(a=q(()=>u(G??=F())),a.f|=E)),w&&l>0&&k(U()),!_)if(b){for(const[Z,j]of d)m.has(Z)||C.skipped_effects.add(j.e);C.oncommit(A),C.ondiscard(()=>{})}else A();R&&z(!0),B(v)}),e={effect:N,items:d,outrogroups:null,fallback:a};_=!1,w&&(s=D)}function Ce(r,n,i,t,g){var u=(t&_e)!==0,s=n.length,d=r.items,f=r.effect.first,o,a=null,v,c=[],_=[],A,N,e,l;if(u)for(l=0;l<s;l+=1)A=n[l],N=g(A,l),e=d.get(N).e,(e.f&E)===0&&(e.nodes?.a?.measure(),(v??=new Set).add(e));for(l=0;l<s;l+=1){if(A=n[l],N=g(A,l),e=d.get(N).e,r.outrogroups!==null)for(const p of r.outrogroups)p.pending.delete(e),p.done.delete(e);if((e.f&E)!==0)if(e.f^=E,e===f)M(e,null,i);else{var R=a?a.next:f;e===r.effect.last&&(r.effect.last=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),T(r,a,e),T(r,e,R),M(e,R,i),a=e,c=[],_=[],f=a.next;continue}if((e.f&L)!==0&&(K(e),u&&(e.nodes?.a?.unfix(),(v??=new Set).delete(e))),e!==f){if(o!==void 0&&o.has(e)){if(c.length<_.length){var S=_[0],m;a=S.prev;var C=c[0],b=c[c.length-1];for(m=0;m<c.length;m+=1)M(c[m],S,i);for(m=0;m<_.length;m+=1)o.delete(_[m]);T(r,C.prev,b.next),T(r,a,C),T(r,b,S),f=S,a=b,l-=1,c=[],_=[]}else o.delete(e),M(e,f,i),T(r,e.prev,e.next),T(r,e,a===null?r.effect.first:a.next),T(r,a,e),a=e;continue}for(c=[],_=[];f!==null&&f!==e;)(o??=new Set).add(f),_.push(f),f=f.next;if(f===null)continue}(e.f&E)===0&&c.push(e),a=e,f=e.next}if(r.outrogroups!==null){for(const p of r.outrogroups)p.pending.size===0&&(V(x(p.done)),r.outrogroups?.delete(p));r.outrogroups.size===0&&(r.outrogroups=null)}if(f!==null||o!==void 0){var h=[];if(o!==void 0)for(e of o)(e.f&L)===0&&h.push(e);for(;f!==null;)(f.f&L)===0&&f!==r.fallback&&h.push(f),f=f.next;var I=h.length;if(I>0){var O=(t&W)!==0&&s===0?i:null;if(u){for(l=0;l<I;l+=1)h[l].nodes?.a?.measure();for(l=0;l<I;l+=1)h[l].nodes?.a?.fix()}Ae(r,h,O)}}u&&pe(()=>{if(v!==void 0)for(e of v)e.nodes?.a?.apply()})}function Ie(r,n,i,t,g,u,s,d){var f=(s&oe)!==0?(s&te)===0?se(i,!1,!1):$(i):null,o=(s&de)!==0?$(g):null;return{v:f,i:o,e:q(()=>(u(n,f??i,o??g,d),()=>{r.delete(t)}))}}function M(r,n,i){if(r.nodes)for(var t=r.nodes.start,g=r.nodes.end,u=n&&(n.f&E)===0?n.nodes.start:i;t!==null;){var s=Q(t);if(u.before(t),t===g)return;t=s}}function T(r,n,i){n===null?r.effect.first=i:n.next=i,i===null?r.effect.last=n:i.prev=n}function Oe(r,n,i=!1,t=!1,g=!1){var u=r,s="";he(()=>{var d=ge;if(s===(s=n()??"")){w&&Y();return}if(d.nodes!==null&&(me(d.nodes.start,d.nodes.end),d.nodes=null),s!==""){if(w){D.data;for(var f=Y(),o=f;f!==null&&(f.nodeType!==J||f.data!=="");)o=f,f=Q(f);if(f===null)throw Ee(),Te;y(D,o),u=k(f);return}var a=s+"";i?a=`<svg>${a}</svg>`:t&&(a=`<math>${a}</math>`);var v=we(a);if((i||t)&&(v=H(v)),y(H(v),v.lastChild),i||t)for(;H(v);)u.before(H(v));else u.before(v)}})}export{be as e,Oe as h,Se as i};
